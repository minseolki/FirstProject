<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"
      crossorigin="anonymous"
    />
    <!-- JavaScript Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
      crossorigin="anonymous"
    ></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>

    <title>로그인</title>
    <style>
      .container {
        width: 100vw;
        height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      form {
        width: 500px;
        background-color: azure;
        height: 300px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .signUp {
        display: flex;
        flex-direction: row;
        margin: 0 auto;
      }

      .signUp > button {
        width: 200px;
      }
    </style>
    <script>
      function signIn() {
        let username = $("#input-username").val();
        let password = $("#input-password").val();
        console.log(username, password);
        if (username == "") {
          $("#help-id-login").text("아이디를 입력해주세요.");
          $("#input-username").focus();
          return;
        } else {
          $("#help-id-login").text("");
        }

        if (password == "") {
          $("#help-password-login").text("비밀번호를 입력해주세요.");
          $("#input-password").focus();
          return;
        } else {
          $("#help-password-login").text("");
        }
        $.ajax({
          type: "POST",
          url: "/api/sign_in",
          data: {
            username_give: username,
            password_give: password,
          },
          success: function (response) {
            if (response["result"] == "success") {
              $.cookie("mytoken", response["token"], { path: "/" });
              window.location.replace("/");
            } else {
              alert(response["msg"]);
            }
          },
        });
      }
    </script>
  </head>
  <body>
    <div class="container">
      <form id="login">
        <h1>오레요</h1>
        <div class="mb-3">
          <label for="exampleFormControlInput1" class="form-label"
            >아이디</label
          >
          <input
            type="email"
            class="form-control"
            id="input-username"
            placeholder="아이디를 입력해주세요."
          />
        </div>
        <div class="mb-3">
          <label for="exampleFormControlInput1" class="form-label"
            >비밀번호</label
          >
          <input
            type="email"
            class="form-control"
            id="input-password"
            placeholder="비밀번호를 입력해주세요."
          />
        </div>

        <button type="button" class="btn btn-primary" onClick="signIn()">
          로그인
        </button>

        <div class="signUp">
          <p>아이디가 없으신가요?</p>
          <a href="/">회원가입</a>
        </div>
      </form>
    </div>
  </body>
</html>
